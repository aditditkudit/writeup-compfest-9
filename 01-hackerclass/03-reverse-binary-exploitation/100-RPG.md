RPG (100)
=========

## Description

`nc tenjin.compfest.web.id 10037`

## Write Up

If we run `strings` to the binary, we can see an interesting line: `Here's a cheat code for skipping the boss fight next time:`. We can try to reverse engineer the cheat code (if you try to decompile it, you can see that it uses unseeded random number as the initial value, then you can just simulate the computation), but let's solve the problem in a more interesting way: *Cheat Engine*.

Cheat Engine allows us to modify memory values of a running process. We can then exploit this to change our HP to some big number so we won't lose from the boss. However since CheatEngine only works in Windows, I will use `scanmem` for this.

```bash
❯ ps aux | grep game
rkkauts+  8552  0.0  0.0  13184  1636 pts/2    S+   14:55   0:00 ./game
rkkauts+  8586  0.0  0.0  11092  2260 pts/4    S+   14:55   0:00 grep --color game

❯ sudo scanmem 8552
```

Then we scan for the value `100` (our hero health).

```
0> 100
01/07 searching   0x602000 -   0x603000..........ok
02/07 searching   0x791000 -   0x7c3000..........ok
03/07 searching 0x7fd0902ea000 - 0x7fd0902ee000..........ok
04/07 searching 0x7fd090b9c000 - 0x7fd090b9f000..........ok
05/07 searching 0x7fd090d75000 - 0x7fd090d7b000..........ok
06/07 searching 0x7fd090dc4000 - 0x7fd090dc5000..........ok
07/07 searching 0x7ffc91792000 - 0x7ffc917b5000..........ok
info: we currently have 82 matches.
```

Then we choose any action in the game, for example, let's defense. Now our health will decrease,

```
>> 2
Hyper Mega Boss attacked you for 34 points.

  ____________________________________________
 / Hero                / Hyper Mega Boss     /
,=====================.======================.
# Health:  66 / 100    # Health: 1000 / 1000 #
# Mana: 100 / 100      # Mana:  500 / 500    #
`====================='======================'
          ' Choose action:      '
          #  [1] Attack         #
          #  [2] Defense        #
          #  [3] Magic          #
          #  [4] Flee           #
          `=====================`
```

Let's continue to scan for the value 66.

```
82> 66
..........info: we currently have 1 matches.
info: match identified, use "set" to modify value.
info: enter "help" for other commands.
```

We got one match. Let's change the value to `999999`:

```
1> set 99999
info: setting *0x602098 to 0x1869f...
```

Then if we attack the boss, we can see that indeed our health has been modified:

```
>> 1
You attacked for 15 points.
Hyper Mega Boss attacked you for 34 points.

  ____________________________________________
 / Hero                / Hyper Mega Boss     /
,=====================.======================.
# Health: 99965 / 100    # Health:  985 / 1000 #
# Mana: 100 / 100      # Mana:  500 / 500    #
`====================='======================'
          ' Choose action:      '
          #  [1] Attack         #
          #  [2] Defense        #
          #  [3] Magic          #
          #  [4] Flee           #
          `=====================`
```

Then we can continue to attack until we win to get the cheat code, and submit it to the server.
